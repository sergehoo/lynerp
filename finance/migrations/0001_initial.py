# Generated by Django 4.2.25 on 2026-02-06 19:59

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('tenants', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Account',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=32)),
                ('name', models.CharField(max_length=128)),
                ('type', models.CharField(choices=[('ASSET', 'Actif'), ('LIABILITY', 'Passif'), ('EQUITY', 'Capitaux'), ('REVENUE', 'Produits'), ('EXPENSE', 'Charges')], db_index=True, max_length=12)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('is_reconcilable', models.BooleanField(default=False)),
                ('allow_manual', models.BooleanField(default=True)),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='children', to='finance.account')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='AccountingPeriod',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=64)),
                ('date_start', models.DateField()),
                ('date_end', models.DateField()),
                ('status', models.CharField(choices=[('OPEN', 'Ouverte'), ('LOCKED', 'Verrouillée'), ('CLOSED', 'Clôturée')], db_index=True, default='OPEN', max_length=10)),
            ],
        ),
        migrations.CreateModel(
            name='BankAccount',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=160)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('iban', models.CharField(blank=True, max_length=64)),
                ('bic', models.CharField(blank=True, max_length=32)),
                ('external_id', models.CharField(blank=True, db_index=True, max_length=128)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('gl_account_code', models.CharField(blank=True, max_length=32)),
            ],
        ),
        migrations.CreateModel(
            name='BankTransaction',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField(db_index=True)),
                ('label', models.CharField(max_length=255)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=14)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('external_id', models.CharField(blank=True, db_index=True, max_length=128)),
                ('raw', models.JSONField(blank=True, default=dict)),
                ('status', models.CharField(choices=[('IMPORTED', 'Importé'), ('MATCHED', 'Rapproché'), ('IGNORED', 'Ignoré')], db_index=True, default='IMPORTED', max_length=10)),
                ('bank_account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='transactions', to='finance.bankaccount')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Invoice',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('type', models.CharField(choices=[('SALE', 'Vente')], default='SALE', max_length=10)),
                ('number', models.CharField(db_index=True, max_length=40)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('ISSUED', 'Émise'), ('PARTIALLY_PAID', 'Partiellement payée'), ('PAID', 'Payée'), ('OVERDUE', 'En retard'), ('CANCELLED', 'Annulée')], db_index=True, default='DRAFT', max_length=16)),
                ('issue_date', models.DateField(default=django.utils.timezone.now)),
                ('due_date', models.DateField(blank=True, db_index=True, null=True)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('notes', models.TextField(blank=True)),
                ('pdf_file', models.FileField(blank=True, upload_to='billing/invoices/%Y/%m/')),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('lock_at', models.DateTimeField(blank=True, null=True)),
                ('journal_entry_id', models.CharField(blank=True, max_length=64)),
                ('lock_owner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoice_locks', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Journal',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=20)),
                ('name', models.CharField(max_length=120)),
                ('type', models.CharField(choices=[('SALES', 'Ventes'), ('PURCHASE', 'Achats'), ('BANK', 'Banque'), ('CASH', 'Caisse'), ('GENERAL', 'Opérations diverses')], db_index=True, default='GENERAL', max_length=12)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('default_credit_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='journals_default_credit', to='finance.account')),
                ('default_debit_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='journals_default_debit', to='finance.account')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='JournalEntry',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('entry_date', models.DateField(db_index=True, default=django.utils.timezone.now)),
                ('reference', models.CharField(blank=True, db_index=True, max_length=80)),
                ('label', models.CharField(max_length=255)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('POSTED', 'Comptabilisée'), ('CANCELLED', 'Annulée')], db_index=True, default='DRAFT', max_length=10)),
                ('source_model', models.CharField(blank=True, max_length=128)),
                ('source_object_id', models.CharField(blank=True, max_length=64)),
                ('journal', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='entries', to='finance.journal')),
                ('period', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='entries', to='finance.accountingperiod')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Partner',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=30)),
                ('name', models.CharField(max_length=160)),
                ('type', models.CharField(choices=[('CUSTOMER', 'Client'), ('SUPPLIER', 'Fournisseur'), ('BOTH', 'Client & Fournisseur')], db_index=True, default='CUSTOMER', max_length=10)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=30)),
                ('address', models.TextField(blank=True)),
                ('vat_number', models.CharField(blank=True, max_length=40)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='PaymentOrder',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=120)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('GENERATED', 'Fichier généré'), ('SENT', 'Envoyé'), ('CONFIRMED', 'Confirmé'), ('CANCELLED', 'Annulé')], db_index=True, default='DRAFT', max_length=12)),
                ('generated_file', models.FileField(blank=True, upload_to='purchasing/payment_orders/%Y/%m/')),
                ('meta', models.JSONField(blank=True, default=dict)),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Quote',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('number', models.CharField(db_index=True, max_length=40)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('SENT', 'Envoyé'), ('ACCEPTED', 'Accepté'), ('REJECTED', 'Rejeté'), ('CANCELLED', 'Annulé')], db_index=True, default='DRAFT', max_length=12)),
                ('issue_date', models.DateField(default=django.utils.timezone.now)),
                ('valid_until', models.DateField(blank=True, null=True)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('notes', models.TextField(blank=True)),
                ('pdf_file', models.FileField(blank=True, upload_to='billing/quotes/%Y/%m/')),
                ('partner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='quotes', to='finance.partner')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Tax',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=80)),
                ('rate', models.DecimalField(decimal_places=2, max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('scope', models.CharField(choices=[('SALES', 'TVA collectée'), ('PURCHASE', 'TVA déductible'), ('BOTH', 'Les deux')], default='BOTH', max_length=10)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('purchase_tax_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tax_purchase', to='finance.account')),
                ('sales_tax_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tax_sales', to='finance.account')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='VendorBill',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('number', models.CharField(db_index=True, max_length=40)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('OCR_EXTRACTED', 'OCR extrait'), ('VALIDATED', 'Validée'), ('POSTED', 'Comptabilisée'), ('PAID', 'Payée'), ('CANCELLED', 'Annulée')], db_index=True, default='DRAFT', max_length=14)),
                ('bill_date', models.DateField(db_index=True, default=django.utils.timezone.now)),
                ('due_date', models.DateField(blank=True, db_index=True, null=True)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('notes', models.TextField(blank=True)),
                ('document', models.FileField(blank=True, upload_to='purchasing/vendor_bills/%Y/%m/')),
                ('ocr_text', models.TextField(blank=True)),
                ('ocr_json', models.JSONField(blank=True, default=dict)),
                ('parsed_json', models.JSONField(blank=True, default=dict)),
                ('validated_at', models.DateTimeField(blank=True, null=True)),
                ('journal_entry_id', models.CharField(blank=True, max_length=64)),
                ('supplier', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='vendor_bills', to='finance.partner')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
                ('validated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='validated_bills', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='VendorBillLine',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('label', models.CharField(max_length=255)),
                ('quantity', models.DecimalField(decimal_places=2, default=1, max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('line_total', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('tax_amount', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('expense_account_code', models.CharField(blank=True, max_length=32)),
                ('bill', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='finance.vendorbill')),
                ('tax', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='finance.tax')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='SubscriptionPlan',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=120)),
                ('description', models.TextField(blank=True)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('interval_unit', models.CharField(choices=[('DAY', 'Jour'), ('WEEK', 'Semaine'), ('MONTH', 'Mois'), ('YEAR', 'Année')], default='MONTH', max_length=8)),
                ('interval_count', models.PositiveIntegerField(default=1)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Subscription',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('PAUSED', 'Suspendue'), ('CANCELLED', 'Annulée'), ('ENDED', 'Terminée')], db_index=True, default='ACTIVE', max_length=12)),
                ('start_date', models.DateField(default=django.utils.timezone.now)),
                ('end_date', models.DateField(blank=True, null=True)),
                ('next_invoice_date', models.DateField(blank=True, db_index=True, null=True)),
                ('last_invoiced_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('partner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='subscriptions', to='finance.partner')),
                ('plan', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='subscriptions', to='finance.subscriptionplan')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='ReportSnapshot',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('report_type', models.CharField(choices=[('TRIAL_BALANCE', 'Balance'), ('GENERAL_LEDGER', 'Grand livre'), ('VAT_REPORT', 'TVA'), ('BALANCE_SHEET', 'Bilan'), ('PROFIT_LOSS', 'Compte de résultat'), ('CASH_FORECAST', 'Prévision trésorerie'), ('AGED_AR', 'Balance âgée clients'), ('AGED_AP', 'Balance âgée fournisseurs')], db_index=True, max_length=24)),
                ('params', models.JSONField(blank=True, default=dict)),
                ('generated_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('generated_by_id', models.CharField(blank=True, max_length=64)),
                ('data', models.JSONField(blank=True, default=dict)),
                ('file', models.FileField(blank=True, upload_to='reporting/%Y/%m/')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='ReconciliationMatch',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('match_type', models.CharField(choices=[('INVOICE_PAYMENT', 'Paiement facture client'), ('VENDOR_PAYMENT', 'Paiement fournisseur'), ('OTHER', 'Autre')], default='OTHER', max_length=20)),
                ('target_model', models.CharField(blank=True, max_length=128)),
                ('target_object_id', models.CharField(blank=True, max_length=64)),
                ('confidence', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('matched_at', models.DateTimeField(auto_now_add=True)),
                ('meta', models.JSONField(blank=True, default=dict)),
                ('bank_transaction', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='match', to='finance.banktransaction')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='QuoteLine',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('label', models.CharField(max_length=255)),
                ('quantity', models.DecimalField(decimal_places=2, default=1, max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('line_total', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('tax_amount', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('quote', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='finance.quote')),
                ('tax', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='finance.tax')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='PaymentOrderLine',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('beneficiary_name', models.CharField(max_length=160)),
                ('beneficiary_iban', models.CharField(blank=True, max_length=64)),
                ('beneficiary_bic', models.CharField(blank=True, max_length=32)),
                ('reference', models.CharField(blank=True, max_length=120)),
                ('bill', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payment_order_lines', to='finance.vendorbill')),
                ('order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='finance.paymentorder')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='Payment',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('method', models.CharField(choices=[('CASH', 'Espèces'), ('BANK', 'Banque'), ('MOBILE', 'Mobile money'), ('CHEQUE', 'Chèque'), ('CARD', 'Carte')], max_length=10)),
                ('status', models.CharField(choices=[('PENDING', 'En attente'), ('DONE', 'Effectué'), ('FAILED', 'Échoué'), ('CANCELLED', 'Annulé')], db_index=True, default='PENDING', max_length=10)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('paid_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('reference', models.CharField(blank=True, max_length=120)),
                ('provider', models.CharField(blank=True, max_length=40)),
                ('provider_payload', models.JSONField(blank=True, default=dict)),
                ('journal_entry_id', models.CharField(blank=True, max_length=64)),
                ('invoice', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payments', to='finance.invoice')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='JournalLine',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('partner_label', models.CharField(blank=True, max_length=160)),
                ('label', models.CharField(blank=True, max_length=255)),
                ('debit', models.DecimalField(decimal_places=2, default=0, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('credit', models.DecimalField(decimal_places=2, default=0, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('amount_currency', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='lines', to='finance.account')),
                ('entry', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='finance.journalentry')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='InvoiceLine',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('label', models.CharField(max_length=255)),
                ('quantity', models.DecimalField(decimal_places=2, default=1, max_digits=10, validators=[django.core.validators.MinValueValidator(0)])),
                ('unit_price', models.DecimalField(decimal_places=2, default=0, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('line_total', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('tax_amount', models.DecimalField(decimal_places=2, default=0, max_digits=14)),
                ('invoice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='finance.invoice')),
                ('tax', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='finance.tax')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='invoice',
            name='partner',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='invoices', to='finance.partner'),
        ),
        migrations.AddField(
            model_name='invoice',
            name='quote',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoices', to='finance.quote'),
        ),
        migrations.AddField(
            model_name='invoice',
            name='tenant',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant'),
        ),
        migrations.CreateModel(
            name='FiscalYear',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=64)),
                ('date_start', models.DateField()),
                ('date_end', models.DateField()),
                ('is_closed', models.BooleanField(db_index=True, default=False)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='FiscalClosing',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('GENERATED', 'Généré'), ('POSTED', 'Comptabilisé')], db_index=True, default='DRAFT', max_length=12)),
                ('generated_at', models.DateTimeField(blank=True, null=True)),
                ('posted_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('closing_entry', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='as_closing_entry', to='finance.journalentry')),
                ('fiscal_year', models.OneToOneField(on_delete=django.db.models.deletion.PROTECT, related_name='closing', to='finance.fiscalyear')),
                ('opening_entry_next_fy', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='as_opening_entry', to='finance.journalentry')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='ExpenseReport',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employee_id', models.CharField(blank=True, db_index=True, max_length=64)),
                ('title', models.CharField(max_length=160)),
                ('status', models.CharField(choices=[('DRAFT', 'Brouillon'), ('SUBMITTED', 'Soumis'), ('MANAGER_APPROVED', 'Validé manager'), ('FINANCE_APPROVED', 'Validé finance'), ('REJECTED', 'Rejeté'), ('PAID', 'Payé'), ('POSTED', 'Comptabilisé')], db_index=True, default='DRAFT', max_length=18)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('journal_entry_id', models.CharField(blank=True, max_length=64)),
                ('approved_by_finance', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='expense_finance_approvals', to=settings.AUTH_USER_MODEL)),
                ('approved_by_manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='expense_manager_approvals', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='ExpenseItem',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField(db_index=True, default=django.utils.timezone.now)),
                ('label', models.CharField(max_length=255)),
                ('category', models.CharField(blank=True, max_length=80)),
                ('currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=14, validators=[django.core.validators.MinValueValidator(0)])),
                ('receipt', models.FileField(blank=True, upload_to='purchasing/expenses/%Y/%m/')),
                ('ocr_text', models.TextField(blank=True)),
                ('ocr_json', models.JSONField(blank=True, default=dict)),
                ('report', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='finance.expensereport')),
                ('tax', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='finance.tax')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='ExchangeRate',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField(db_index=True)),
                ('base_currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], max_length=3)),
                ('quote_currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], max_length=3)),
                ('rate', models.DecimalField(decimal_places=8, max_digits=18, validators=[django.core.validators.MinValueValidator(0)])),
                ('source', models.CharField(blank=True, max_length=80)),
                ('is_locked', models.BooleanField(db_index=True, default=False)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='DunningStage',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=80)),
                ('days_after_due', models.PositiveIntegerField()),
                ('email_subject', models.CharField(max_length=160)),
                ('email_body', models.TextField()),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='DunningEvent',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('sent_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('channel', models.CharField(default='EMAIL', max_length=20)),
                ('meta', models.JSONField(blank=True, default=dict)),
                ('invoice', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='dunning_events', to='finance.invoice')),
                ('stage', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='events', to='finance.dunningstage')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='CustomerPortalToken',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('token', models.CharField(db_index=True, max_length=64, unique=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('partner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='portal_tokens', to='finance.partner')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='CompanyFinanceProfile',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('base_currency', models.CharField(choices=[('XOF', 'Franc CFA (XOF)'), ('XAF', 'Franc CFA (XAF)'), ('EUR', 'Euro'), ('USD', 'Dollar US'), ('GBP', 'Livre Sterling')], default='XOF', max_length=3)),
                ('standard', models.CharField(choices=[('SYSCOHADA', 'SYSCOHADA'), ('PCG', 'PCG (France)'), ('IFRS', 'IFRS'), ('CUSTOM', 'Custom')], default='SYSCOHADA', max_length=12)),
                ('invoice_prefix', models.CharField(default='INV', max_length=20)),
                ('bill_prefix', models.CharField(default='BILL', max_length=20)),
                ('quote_prefix', models.CharField(default='QT', max_length=20)),
                ('lock_posted_entries', models.BooleanField(default=True)),
                ('require_attachments_for_expenses', models.BooleanField(default=False)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.CreateModel(
            name='BankConnector',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('provider', models.CharField(choices=[('MANUAL', 'Manual/CSV'), ('BRIDGE', 'Bridge'), ('TINK', 'Tink')], default='MANUAL', max_length=12)),
                ('name', models.CharField(max_length=120)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('credentials', models.JSONField(blank=True, default=dict)),
                ('last_sync_at', models.DateTimeField(blank=True, null=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.AddField(
            model_name='bankaccount',
            name='connector',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='accounts', to='finance.bankconnector'),
        ),
        migrations.AddField(
            model_name='bankaccount',
            name='tenant',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant'),
        ),
        migrations.CreateModel(
            name='AuditEvent',
            fields=[
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('CREATE', 'Create'), ('UPDATE', 'Update'), ('DELETE', 'Delete'), ('POST', 'Post'), ('REVERSE', 'Reverse'), ('LOCK', 'Lock'), ('UNLOCK', 'Unlock'), ('CLOSE', 'Close'), ('SYNC', 'Sync'), ('IMPORT', 'Import'), ('EXPORT', 'Export'), ('LOGIN', 'Login'), ('OTHER', 'Other')], db_index=True, max_length=12)),
                ('model_label', models.CharField(db_index=True, max_length=128)),
                ('object_id', models.CharField(db_index=True, max_length=64)),
                ('object_repr', models.CharField(blank=True, max_length=255)),
                ('before', models.JSONField(blank=True, default=dict)),
                ('after', models.JSONField(blank=True, default=dict)),
                ('meta', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('prev_hash', models.CharField(blank=True, db_index=True, max_length=64)),
                ('event_hash', models.CharField(blank=True, db_index=True, max_length=64)),
                ('actor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_events', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant')),
            ],
        ),
        migrations.AddField(
            model_name='accountingperiod',
            name='fiscal_year',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='periods', to='finance.fiscalyear'),
        ),
        migrations.AddField(
            model_name='accountingperiod',
            name='tenant',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(app_label)s_%(class)ss', related_query_name='%(app_label)s_%(class)s', to='tenants.tenant'),
        ),
        migrations.AddIndex(
            model_name='vendorbill',
            index=models.Index(fields=['tenant', 'status'], name='finance_ven_tenant__307a33_idx'),
        ),
        migrations.AddIndex(
            model_name='vendorbill',
            index=models.Index(fields=['tenant', 'bill_date'], name='finance_ven_tenant__d13c30_idx'),
        ),
        migrations.AddIndex(
            model_name='vendorbill',
            index=models.Index(fields=['tenant', 'due_date'], name='finance_ven_tenant__954c56_idx'),
        ),
        migrations.AddConstraint(
            model_name='vendorbill',
            constraint=models.UniqueConstraint(fields=('tenant', 'number'), name='uniq_vendor_bill_number'),
        ),
        migrations.AddIndex(
            model_name='tax',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_tax_tenant__749a5c_idx'),
        ),
        migrations.AddIndex(
            model_name='tax',
            index=models.Index(fields=['tenant', 'scope'], name='finance_tax_tenant__8feba0_idx'),
        ),
        migrations.AddIndex(
            model_name='subscriptionplan',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_sub_tenant__370454_idx'),
        ),
        migrations.AddIndex(
            model_name='subscription',
            index=models.Index(fields=['tenant', 'status'], name='finance_sub_tenant__6ed7d3_idx'),
        ),
        migrations.AddIndex(
            model_name='subscription',
            index=models.Index(fields=['tenant', 'next_invoice_date'], name='finance_sub_tenant__494e74_idx'),
        ),
        migrations.AddIndex(
            model_name='reportsnapshot',
            index=models.Index(fields=['tenant', 'report_type'], name='finance_rep_tenant__2812e9_idx'),
        ),
        migrations.AddIndex(
            model_name='reportsnapshot',
            index=models.Index(fields=['tenant', 'generated_at'], name='finance_rep_tenant__42c901_idx'),
        ),
        migrations.AddIndex(
            model_name='reconciliationmatch',
            index=models.Index(fields=['tenant', 'matched_at'], name='finance_rec_tenant__bf7464_idx'),
        ),
        migrations.AddIndex(
            model_name='reconciliationmatch',
            index=models.Index(fields=['tenant', 'match_type'], name='finance_rec_tenant__9d8533_idx'),
        ),
        migrations.AddIndex(
            model_name='quote',
            index=models.Index(fields=['tenant', 'status'], name='finance_quo_tenant__6c977d_idx'),
        ),
        migrations.AddIndex(
            model_name='quote',
            index=models.Index(fields=['tenant', 'issue_date'], name='finance_quo_tenant__723a17_idx'),
        ),
        migrations.AddConstraint(
            model_name='quote',
            constraint=models.UniqueConstraint(fields=('tenant', 'number'), name='uniq_quote_number'),
        ),
        migrations.AddIndex(
            model_name='paymentorderline',
            index=models.Index(fields=['tenant', 'currency'], name='finance_pay_tenant__6c45be_idx'),
        ),
        migrations.AddConstraint(
            model_name='paymentorderline',
            constraint=models.UniqueConstraint(fields=('tenant', 'order', 'bill'), name='uniq_bill_once_in_order'),
        ),
        migrations.AddIndex(
            model_name='paymentorder',
            index=models.Index(fields=['tenant', 'status'], name='finance_pay_tenant__8b6575_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['tenant', 'status'], name='finance_pay_tenant__52374b_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['tenant', 'paid_at'], name='finance_pay_tenant__8739c2_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['tenant', 'provider'], name='finance_pay_tenant__6a5089_idx'),
        ),
        migrations.AddIndex(
            model_name='partner',
            index=models.Index(fields=['tenant', 'type'], name='finance_par_tenant__4c09c5_idx'),
        ),
        migrations.AddIndex(
            model_name='partner',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_par_tenant__ae2942_idx'),
        ),
        migrations.AddConstraint(
            model_name='partner',
            constraint=models.UniqueConstraint(fields=('tenant', 'code'), name='uniq_partner_code'),
        ),
        migrations.AddIndex(
            model_name='journalline',
            index=models.Index(fields=['tenant', 'account'], name='finance_jou_tenant__e78842_idx'),
        ),
        migrations.AddIndex(
            model_name='journalline',
            index=models.Index(fields=['tenant', 'currency'], name='finance_jou_tenant__5f391b_idx'),
        ),
        migrations.AddConstraint(
            model_name='journalline',
            constraint=models.CheckConstraint(check=models.Q(models.Q(('debit__gt', 0), ('credit', 0)), models.Q(('credit__gt', 0), ('debit', 0)), models.Q(('credit', 0), ('debit', 0)), _connector='OR'), name='line_debit_or_credit_only'),
        ),
        migrations.AddIndex(
            model_name='journalentry',
            index=models.Index(fields=['tenant', 'status'], name='finance_jou_tenant__604d35_idx'),
        ),
        migrations.AddIndex(
            model_name='journalentry',
            index=models.Index(fields=['tenant', 'entry_date'], name='finance_jou_tenant__e88f05_idx'),
        ),
        migrations.AddIndex(
            model_name='journalentry',
            index=models.Index(fields=['tenant', 'reference'], name='finance_jou_tenant__37599e_idx'),
        ),
        migrations.AddIndex(
            model_name='journal',
            index=models.Index(fields=['tenant', 'type'], name='finance_jou_tenant__9e37df_idx'),
        ),
        migrations.AddIndex(
            model_name='journal',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_jou_tenant__7b9699_idx'),
        ),
        migrations.AddConstraint(
            model_name='journal',
            constraint=models.UniqueConstraint(fields=('tenant', 'code'), name='uniq_journal_code'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['tenant', 'status'], name='finance_inv_tenant__e82747_idx'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['tenant', 'issue_date'], name='finance_inv_tenant__c5242e_idx'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['tenant', 'due_date'], name='finance_inv_tenant__14e836_idx'),
        ),
        migrations.AddConstraint(
            model_name='invoice',
            constraint=models.UniqueConstraint(fields=('tenant', 'number'), name='uniq_invoice_number'),
        ),
        migrations.AddIndex(
            model_name='fiscalyear',
            index=models.Index(fields=['tenant', 'is_closed'], name='finance_fis_tenant__18bcf1_idx'),
        ),
        migrations.AddConstraint(
            model_name='fiscalyear',
            constraint=models.CheckConstraint(check=models.Q(('date_end__gte', models.F('date_start'))), name='fy_dates_ok'),
        ),
        migrations.AddConstraint(
            model_name='fiscalyear',
            constraint=models.UniqueConstraint(fields=('tenant', 'name'), name='uniq_fy_name_per_tenant'),
        ),
        migrations.AddIndex(
            model_name='fiscalclosing',
            index=models.Index(fields=['tenant', 'status'], name='finance_fis_tenant__4c1631_idx'),
        ),
        migrations.AddIndex(
            model_name='expensereport',
            index=models.Index(fields=['tenant', 'status'], name='finance_exp_tenant__0f5ee4_idx'),
        ),
        migrations.AddIndex(
            model_name='expensereport',
            index=models.Index(fields=['tenant', 'employee_id'], name='finance_exp_tenant__ec74b8_idx'),
        ),
        migrations.AddIndex(
            model_name='expenseitem',
            index=models.Index(fields=['tenant', 'date'], name='finance_exp_tenant__c7462c_idx'),
        ),
        migrations.AddIndex(
            model_name='expenseitem',
            index=models.Index(fields=['tenant', 'category'], name='finance_exp_tenant__122da9_idx'),
        ),
        migrations.AddIndex(
            model_name='exchangerate',
            index=models.Index(fields=['tenant', 'date'], name='finance_exc_tenant__a5c547_idx'),
        ),
        migrations.AddIndex(
            model_name='exchangerate',
            index=models.Index(fields=['tenant', 'base_currency', 'quote_currency'], name='finance_exc_tenant__0ec28a_idx'),
        ),
        migrations.AddConstraint(
            model_name='exchangerate',
            constraint=models.CheckConstraint(check=models.Q(('base_currency', models.F('quote_currency')), _negated=True), name='fx_currencies_diff'),
        ),
        migrations.AddConstraint(
            model_name='exchangerate',
            constraint=models.UniqueConstraint(fields=('tenant', 'date', 'base_currency', 'quote_currency'), name='uniq_fx_rate_per_day'),
        ),
        migrations.AddIndex(
            model_name='dunningstage',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_dun_tenant__8d4340_idx'),
        ),
        migrations.AddConstraint(
            model_name='dunningstage',
            constraint=models.UniqueConstraint(fields=('tenant', 'days_after_due'), name='uniq_dunning_day'),
        ),
        migrations.AddIndex(
            model_name='dunningevent',
            index=models.Index(fields=['tenant', 'sent_at'], name='finance_dun_tenant__873727_idx'),
        ),
        migrations.AddConstraint(
            model_name='dunningevent',
            constraint=models.UniqueConstraint(fields=('tenant', 'invoice', 'stage'), name='uniq_dunning_once'),
        ),
        migrations.AddConstraint(
            model_name='companyfinanceprofile',
            constraint=models.UniqueConstraint(fields=('tenant',), name='uniq_fin_profile_per_tenant'),
        ),
        migrations.AddIndex(
            model_name='banktransaction',
            index=models.Index(fields=['tenant', 'date'], name='finance_ban_tenant__2e6572_idx'),
        ),
        migrations.AddIndex(
            model_name='banktransaction',
            index=models.Index(fields=['tenant', 'status'], name='finance_ban_tenant__eea679_idx'),
        ),
        migrations.AddConstraint(
            model_name='banktransaction',
            constraint=models.UniqueConstraint(condition=models.Q(('external_id', ''), _negated=True), fields=('tenant', 'bank_account', 'external_id'), name='uniq_bank_txn_external'),
        ),
        migrations.AddIndex(
            model_name='bankconnector',
            index=models.Index(fields=['tenant', 'provider'], name='finance_ban_tenant__f23e8e_idx'),
        ),
        migrations.AddIndex(
            model_name='bankconnector',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_ban_tenant__0d5e4c_idx'),
        ),
        migrations.AddIndex(
            model_name='bankaccount',
            index=models.Index(fields=['tenant', 'currency'], name='finance_ban_tenant__f63d23_idx'),
        ),
        migrations.AddIndex(
            model_name='bankaccount',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_ban_tenant__36da2d_idx'),
        ),
        migrations.AddConstraint(
            model_name='bankaccount',
            constraint=models.UniqueConstraint(condition=models.Q(('external_id', ''), _negated=True), fields=('tenant', 'external_id'), name='uniq_bank_account_external'),
        ),
        migrations.AddIndex(
            model_name='auditevent',
            index=models.Index(fields=['tenant', 'created_at'], name='finance_aud_tenant__e905d6_idx'),
        ),
        migrations.AddIndex(
            model_name='auditevent',
            index=models.Index(fields=['tenant', 'model_label', 'object_id'], name='finance_aud_tenant__1e8bc8_idx'),
        ),
        migrations.AddIndex(
            model_name='auditevent',
            index=models.Index(fields=['tenant', 'action'], name='finance_aud_tenant__a2a834_idx'),
        ),
        migrations.AddIndex(
            model_name='accountingperiod',
            index=models.Index(fields=['tenant', 'fiscal_year'], name='finance_acc_tenant__4702f1_idx'),
        ),
        migrations.AddIndex(
            model_name='accountingperiod',
            index=models.Index(fields=['tenant', 'status'], name='finance_acc_tenant__ef8b58_idx'),
        ),
        migrations.AddConstraint(
            model_name='accountingperiod',
            constraint=models.CheckConstraint(check=models.Q(('date_end__gte', models.F('date_start'))), name='period_dates_ok'),
        ),
        migrations.AddConstraint(
            model_name='accountingperiod',
            constraint=models.UniqueConstraint(fields=('tenant', 'fiscal_year', 'name'), name='uniq_period_name'),
        ),
        migrations.AddIndex(
            model_name='account',
            index=models.Index(fields=['tenant', 'code'], name='finance_acc_tenant__5752e5_idx'),
        ),
        migrations.AddIndex(
            model_name='account',
            index=models.Index(fields=['tenant', 'type'], name='finance_acc_tenant__3b4d13_idx'),
        ),
        migrations.AddIndex(
            model_name='account',
            index=models.Index(fields=['tenant', 'is_active'], name='finance_acc_tenant__ae294a_idx'),
        ),
        migrations.AddConstraint(
            model_name='account',
            constraint=models.UniqueConstraint(fields=('tenant', 'code'), name='uniq_account_code'),
        ),
    ]
